{
  "version": 3,
  "sources": ["../../svelte/src/internal/client/timing.js", "../../svelte/src/internal/client/loop.js"],
  "sourcesContent": ["import { noop } from '../shared/utils.js';\n\nconst is_client = typeof window !== 'undefined';\n\nconst request_animation_frame = is_client ? requestAnimationFrame : noop;\n\nconst now = is_client ? () => performance.now() : () => Date.now();\n\n/** @type {import('#client').Raf} */\nexport const raf = {\n\ttick: /** @param {any} _ */ (_) => request_animation_frame(_),\n\tnow: () => now(),\n\ttasks: new Set()\n};\n", "import { raf } from './timing.js';\n\n// TODO move this into timing.js where it probably belongs\n\n/**\n * @param {number} now\n * @returns {void}\n */\nfunction run_tasks(now) {\n\traf.tasks.forEach((task) => {\n\t\tif (!task.c(now)) {\n\t\t\traf.tasks.delete(task);\n\t\t\ttask.f();\n\t\t}\n\t});\n\n\tif (raf.tasks.size !== 0) {\n\t\traf.tick(run_tasks);\n\t}\n}\n\n/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n * @param {import('#client').TaskCallback} callback\n * @returns {import('#client').Task}\n */\nexport function loop(callback) {\n\t/** @type {import('#client').TaskEntry} */\n\tlet task;\n\n\tif (raf.tasks.size === 0) {\n\t\traf.tick(run_tasks);\n\t}\n\n\treturn {\n\t\tpromise: new Promise((fulfill) => {\n\t\t\traf.tasks.add((task = { c: callback, f: fulfill }));\n\t\t}),\n\t\tabort() {\n\t\t\traf.tasks.delete(task);\n\t\t}\n\t};\n}\n"],
  "mappings": ";;;;;AAEA,IAAM,YAAY,OAAO,WAAW;AAEpC,IAAM,0BAA0B,YAAY,wBAAwB;AAEpE,IAAM,MAAM,YAAY,MAAM,YAAY,IAAI,IAAI,MAAM,KAAK,IAAI;AAG1D,IAAM,MAAM;AAAA,EAClB;AAAA;AAAA,IAA4B,CAAC,MAAM,wBAAwB,CAAC;AAAA;AAAA,EAC5D,KAAK,MAAM,IAAI;AAAA,EACf,OAAO,oBAAI,IAAI;AAChB;;;ACLA,SAAS,UAAUA,MAAK;AACvB,MAAI,MAAM,QAAQ,CAAC,SAAS;AAC3B,QAAI,CAAC,KAAK,EAAEA,IAAG,GAAG;AACjB,UAAI,MAAM,OAAO,IAAI;AACrB,WAAK,EAAE;AAAA,IACR;AAAA,EACD,CAAC;AAED,MAAI,IAAI,MAAM,SAAS,GAAG;AACzB,QAAI,KAAK,SAAS;AAAA,EACnB;AACD;AAQO,SAAS,KAAK,UAAU;AAE9B,MAAI;AAEJ,MAAI,IAAI,MAAM,SAAS,GAAG;AACzB,QAAI,KAAK,SAAS;AAAA,EACnB;AAEA,SAAO;AAAA,IACN,SAAS,IAAI,QAAQ,CAAC,YAAY;AACjC,UAAI,MAAM,IAAK,OAAO,EAAE,GAAG,UAAU,GAAG,QAAQ,CAAE;AAAA,IACnD,CAAC;AAAA,IACD,QAAQ;AACP,UAAI,MAAM,OAAO,IAAI;AAAA,IACtB;AAAA,EACD;AACD;",
  "names": ["now"]
}
